(()=>{var e={};e.id=220,e.ids=[220],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},918:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>f,routeModule:()=>h,serverHooks:()=>x,workAsyncStorage:()=>v,workUnitAsyncStorage:()=>w});var s={};r.r(s),r.d(s,{DELETE:()=>g,GET:()=>p,PATCH:()=>m,POST:()=>l});var o=r(2706),n=r(8203),a=r(5994),i=r(9064),u=r(4512),d=r(9187);async function c(){let e=await (0,u.UL)();return(0,i.createServerClient)("https://uoogquwrzytpnyhjkqpk.supabase.co","sb_publishable_t4ETXw2dUK4_0L4m1KepXg_HwmDH7Vx",{cookies:{get:t=>e.get(t)?.value,set(t,r,s){try{e.set({name:t,value:r,...s})}catch(e){}},remove(t,r){try{e.set({name:t,value:"",...r})}catch(e){}}}})}async function p(){try{let e=await c(),{data:{user:t}}=await e.auth.getUser();if(!t)return d.NextResponse.json({error:"Unauthorized"},{status:401});let{data:r,error:s}=await e.from("documents").select("*").eq("user_id",t.id).order("position",{ascending:!0}).order("created_at",{ascending:!1});if(s)throw s;return d.NextResponse.json(r||[])}catch(e){return console.error("Error fetching documents:",e),d.NextResponse.json({error:"Failed to fetch documents"},{status:500})}}async function l(e){try{let t=await c(),{data:{user:r}}=await t.auth.getUser();if(!r)return d.NextResponse.json({error:"Unauthorized"},{status:401});let{title:s,company:o,role:n,content:a,jobPostUrl:i,status:u,tags:p,deadline:l,date:g,logo:m,position:h,isArchived:v,documentScreeningStatus:w}=await e.json(),x=m||(o?o.charAt(0).toUpperCase():"C"),{data:f,error:j}=await t.from("documents").insert([{user_id:r.id,title:s,company:o,role:n,content:a,job_post_url:i,status:u||"writing",tags:p||[],deadline:l,date:g,logo:x,position:h||0,is_archived:!!v,document_screening_status:w??null}]).select().single();if(j)throw j;return d.NextResponse.json(f)}catch(e){return console.error("Error creating document:",e),d.NextResponse.json({error:"Failed to create document"},{status:500})}}async function g(e){try{let t=await c(),{data:{user:r}}=await t.auth.getUser();if(!r)return d.NextResponse.json({error:"Unauthorized"},{status:401});let{searchParams:s}=new URL(e.url),o=s.get("id");if(!o)return d.NextResponse.json({error:"ID is required"},{status:400});let{error:n}=await t.from("documents").delete().eq("id",o).eq("user_id",r.id);if(n)throw n;return d.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting document:",e),d.NextResponse.json({error:"Failed to delete document"},{status:500})}}async function m(e){try{let t=await c(),{data:{user:r}}=await t.auth.getUser();if(!r)return d.NextResponse.json({error:"Unauthorized"},{status:401});let{searchParams:s}=new URL(e.url),o=s.get("id");if(!o)return d.NextResponse.json({error:"ID is required"},{status:400});let{title:n,company:a,role:i,content:u,jobPostUrl:p,status:l,tags:g,deadline:m,date:h,logo:v,position:w,isArchived:x,documentScreeningStatus:f}=await e.json(),j={};void 0!==n&&(j.title=n),void 0!==a&&(j.company=a),void 0!==i&&(j.role=i),void 0!==u&&(j.content=u),void 0!==p&&(j.job_post_url=p),void 0!==l&&(j.status=l),void 0!==g&&(j.tags=g),void 0!==m&&(j.deadline=m),void 0!==h&&(j.date=h),void 0!==v&&(j.logo=v),void 0!==w&&(j.position=w),void 0!==x&&(j.is_archived=x),void 0!==f&&(j.document_screening_status=f),j.updated_at=new Date().toISOString();let{data:_,error:R}=await t.from("documents").update(j).eq("id",o).eq("user_id",r.id).select().single();if(R)throw R;return d.NextResponse.json(_)}catch(e){return console.error("Error updating document:",e),d.NextResponse.json({error:"Failed to update document",details:e instanceof Error?e.message:String(e)},{status:500})}}let h=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/documents/route",pathname:"/api/documents",filename:"route",bundlePath:"app/api/documents/route"},resolvedPagePath:"/Users/junha/coding/careervault-ai/app/api/documents/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:v,workUnitAsyncStorage:w,serverHooks:x}=h;function f(){return(0,a.patchFetch)({workAsyncStorage:v,workUnitAsyncStorage:w})}},6487:()=>{},8335:()=>{}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[10,629],()=>r(918));module.exports=s})();